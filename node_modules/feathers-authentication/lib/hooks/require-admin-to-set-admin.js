'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = requireAdminToSetAdmin;
/**
 * If the user is not an admin, remove any admin attribute.  This prevents
 * unauthorized users from setting other users up as administrators.
 * This typically would be used on a user-type service.
 *
 * create, update, patch
 */
function requireAdminToSetAdmin() {
  var adminField = arguments.length <= 0 || arguments[0] === undefined ? 'admin' : arguments[0];

  return function (hook) {

    if (hook.params.user && !hook.params.user[adminField] && hook.params.provider) {
      delete hook.data[adminField];
    }
  };
}
module.exports = exports['default'];